<!DOCTYPE html>
<html lang="en" id="html_main">
<head>
    <!-- Required meta tags -->
    <title>main</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script>
        function View(){
            document.getElementById("body").style.overflow="hidden";
            document.getElementById("levelLayout").style.display='inline';

        }
        function Close(){
            document.getElementById("levelLayout").style.display='none';
        }
    </script>
</head>
<body id="body">
<div class="wrapper" style="position: absolute;">
    <div class="header_main">
        <div class="imgGra_main">
            <img src="img/main.png"
                 class="mainimg">
            <img src="img/logotype@2x.png"
                 class="logotype">
        </div>
    </div>
    <div class="content_main">
        <div class="rec1_weather_main">
            <div class="rec1_wcontenets_main">
                <div class="rec1_temp_main"></div>
                <div class="rec1_word_main"></div>
                <div class="rec1_local_main"></div>
            </div>
            <div class="rec1_wpic_main">
                <img class="sun">
            </div>
        </div>
        <div class="rec2_status_main">
            <div class="current_status">
                <div class="img_current_status">
                    <img class="ic_level">
                    <a href="javascript:View();"><img src="img/ic-help@2x.png" class="ic_help"></a>
                </div>
                <div class="name_current_status"></div>
                <div class="points_current_status"></div>
                <div class="bar_current_status">
                    <div class="done_current_status"></div>
                </div>
            </div>
        </div>
        <div class="rec3_link_main">
            <a href="02_mypage.html">
                <div class="rec3_mypage_main">
                    <div class="rec3_img_main">
                        <img src="img/ic-mypage@2x.png"
                            class="ic_mypage">
                    </div>
                    <div class="rec3_name_main">마이페이지</div>
                </div>
            </a>
            <a href="04_1_hpConnectMap.html">
                <div class="rec3_map_main">
                    <div class="rec3_img_main">
                        <img src="img/ic-map@2x.png"
                            class="ic_map">
                    </div>
                    <div class="rec3_name_main">지도</div>
                </div>
            </a>
            <a href="04_hpConnect.html">
                <div class="rec3_castle_main">
                    <div class="rec3_img_main">
                        <img src="img/ic-castle@2x.png"
                            class="ic_castle">
                    </div>
                    <div class="rec3_name_main">고궁연결</div>
                </div>
            </a>
        </div>
    </div>
</div>

<!-- 상세 설명 popup -->
<div id="levelLayout">
    <div class="wrapper_popUp">
        <div class="content_popUp">
            <div class="header_popUp">
                <span class="header_title">계급</span>
                <a href="01_0_main.html">
                    <img src="img/ic-clear@2x.png"
                            class="ic_clear">
                </a>
            </div>
            <div class="result_popUp">
                <!-- king div -->
                <div class="rec1_mainLevel">
                    <div class="rec1_current5_mainLevel"></div>
                    <div class="rec1_level_mainLevel">
                        <img src="img/ic-level-king@2x.png"
                                class="ic_level_king">
                    </div>
                    <div class="rec1_infoBox_mainLevel">
                        <div class="rec1_info1_mainLevel">1계층</div>
                        <div class="rec1_info2_mainLevel">왕</div>
                    </div>
                </div>
                <!-- gentleman div -->
                <div class="rec1_mainLevel">
                    <div class="rec1_current4_mainLevel"></div>
                    <div class="rec1_level_mainLevel">
                        <img src="img/ic-level-gentleman@2x.png"
                            class="ic_level_gentleman">
                    </div>
                    <div class="rec1_infoBox_mainLevel">
                        <div class="rec1_info1_mainLevel">2계층</div>
                        <div class="rec1_info2_mainLevel">양반</div>
                    </div>
                </div>
                <!-- general div -->
                <div class="rec1_mainLevel">
                    <div class="rec1_current3_mainLevel"></div>
                    <div class="rec1_level_mainLevel">
                        <img src="img/ic-level-general@2x.png"
                                class="ic_level_general">
                    </div>
                    <div class="rec1_infoBox_mainLevel">
                        <div class="rec1_info1_mainLevel">3계층</div>
                        <div class="rec1_info2_mainLevel">관리</div>
                    </div>
                </div>
                <!-- civilian div -->
                <div class="rec1_mainLevel">
                    <div class="rec1_current2_mainLevel"></div>
                    <div class="rec1_level_mainLevel">
                        <img src="img/ic-level-civilian@2x.png"
                                class="ic_level_civilian">
                    </div>
                    <div class="rec1_infoBox_mainLevel">
                        <div class="rec1_info1_mainLevel">4계층</div>
                        <div class="rec1_info2_mainLevel">평민</div>
                    </div>
                </div>
                <!-- labor div -->
                <div class="rec1_mainLevel">
                    <div class="rec1_current1_mainLevel"></div>
                    <div class="rec1_level_mainLevel">
                        <img src="img/ic-level-labor@2x.png"
                            class="ic_level_labor">
                    </div>
                    <div class="rec1_infoBox_mainLevel">
                        <div class="rec1_info1_mainLevel">5계층</div>
                        <div class="rec1_info2_mainLevel">노비</div>
                    </div>
                </div>
            </div>
            <a href="01_0_main.html">
                <div class="btn_popUp_main">

                    <span class="btn_popUp_text">확인</span>
                </div>
            </a>
        </div>
    </div>
</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script>
    var apiURI = "http://api.openweathermap.org/data/2.5/weather?lat=37.58&lon=126.98&appid=cd9c8e6ad0836b458374b0a5a9237b62";
    var userID = "id="+ sessionStorage.getItem("id");
    
    //날씨 ajax
    $.ajax({
        url: apiURI,
        dataType: "json",
        type: "GET",
        async: "false",
        success: function(resp) {
            $('.rec1_local_main').text( resp.name+', '+resp.sys.country);
            $('.rec1_temp_main').text(Math.round(resp.main.temp- 273.15)+'ºC');
            if(resp.weather[0].id == 800){ // 화창한날
                var imgURL = "img/svg/wi-day-sunny.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("오늘은 산책하기 좋은 날씨네요.");
            } else if(resp.weather[0].id == 200 || resp.weather[0].id == 201 || resp.weather[0].id == 202 || resp.weather[0].id == 230 || resp.weather[0].id == 231 || resp.weather[0].id == 232){
                //뇌우
                var imgURL = "img/svg/wi-thunderstorm.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("우산이나 우비를 챙겨주세요~!");
            } else if(resp.weather[0].id == 210 || resp.weather[0].id == 211 || resp.weather[0].id == 212 || resp.weather[0].id == 221){
                //번개
                var imgURL = "img/svg/wi-lightning.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("우산이나 우비를 챙겨주세요~!");
            } else if(resp.weather[0].id == 300 || resp.weather[0].id == 301 || resp.weather[0].id == 321 || resp.weather[0].id == 500){
                //보슬비
                var imgURL = "img/svg/wi-sprinkle.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("우산이나 우비를 챙겨주세요~!");
            } else if(resp.weather[0].id == 302 || resp.weather[0].id == 311 || resp.weather[0].id == 312 || resp.weather[0].id == 314 || resp.weather[0].id == 501 || resp.weather[0].id == 502 || resp.weather[0].id == 503 || resp.weather[0].id == 504){
                //비
                var imgURL = "img/svg/wi-rain.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("우산이나 우비를 챙겨주세요~!");
            } else if(resp.weather[0].id == 310 || resp.weather[0].id == 511 || resp.weather[0].id == 611 || resp.weather[0].id == 612 || resp.weather[0].id == 615 || resp.weather[0].id == 616 || resp.weather[0].id == 620){
                //비-mix
                var imgURL = "img/svg/wi-rain-mix.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("우산이나 우비를 챙겨주세요~!");
            } else if(resp.weather[0].id == 313 || resp.weather[0].id == 520 || resp.weather[0].id == 521 || resp.weather[0].id == 522 || resp.weather[0].id == 701){
                //소나기
                var imgURL = "img/svg/wi-showers.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("우산이나 우비를 챙겨주세요~!");
            } else if(resp.weather[0].id == 531 || resp.weather[0].id == 901){
                //폭풍우
                var imgURL = "img/svg/wi-storm-showers.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("우산이나 우비를 챙겨주세요~!");
            } else if(resp.weather[0].id == 600 || resp.weather[0].id == 601 || resp.weather[0].id == 621 || resp.weather[0].id == 622){
                //눈
                var imgURL = "img/svg/wi-snow.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("미끄러지지 않게 주의하세요.");
            } else if(resp.weather[0].id == 602){
                //진눈깨비
                var imgURL = "img/svg/wi-sleet.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("갑자기 눈이 내릴지도 몰라요.");
            } else if(resp.weather[0].id == 721){
                //낮안개
                var imgURL = "img/svg/wi-day-haze.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("산책하기 괜찮은 날씨네요.");
            } else if(resp.weather[0].id == 731 || resp.weather[0].id == 761 || resp.weather[0].id == 762){
                //미세먼지
                var imgURL = "img/svg/wi-dust.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("마스크를 꼭 챙기세요.");
            } else if(resp.weather[0].id == 741){
                //안개
                var imgURL = "img/svg/wi-fog.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("오늘은 천천히 걸어볼까요?");
            } else if(resp.weather[0].id == 771 || resp.weather[0].id == 801 || resp.weather[0].id == 802 || resp.weather[0].id == 803){
                //구름, 돌풍
                var imgURL = "img/svg/wi-cloudy-gusts.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("산책하기 알맞은 날씨네요.");
            } else if(resp.weather[0].id == 804){
                //흐린 날
                var imgURL = "img/svg/wi-cloudy.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("오늘은 천천히 걸어볼까요?");
            } else if(resp.weather[0].id == 903){
                //눈송이
                var imgURL = "img/svg/wi-snowflake-cold.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("함박눈이 내려요.");
            } else if(resp.weather[0].id == 904){
                //폭염
                var imgURL = "img/svg/wi-hot.svg";
                $(".sun").attr("src", imgURL);
                $(".rec1_word_main").text("시원한 물 챙기는 거 잊지마세요.");
            } 
            
        }
    });

    //계급 ajax
    $.ajax({
    type: "POST",
    url: "http://13.125.138.168:8080/gungduk/api/v1/finishQuest",
    data: userID,
    async: false,
    success: function(data){
        //계급 이름, 사진 변경과 퍼센테이지 변경
        if ( data.level == 1 ){
            $(".ic_level").attr('src','img/ic-level-labor@2x.png');
            $(".name_current_status").text("노비");
            $(".points_current_status").text(data.percent + "%");
            $(".done_current_status").css({
                'width': data.percent + "%"
            });
        } else if ( data.level == 2 ){
            $(".ic_level").attr('src','img/ic-level-civilian@2x.png');
            $(".name_current_status").text("평민");
            $(".points_current_status").text(data.percent + "%");
            $(".done_current_status").css({
                'width': data.percent + "%"
            });
        } else if ( data.level == 3 ){
            $(".ic_level").attr('src','img/ic-level-general@2x.png');
            $(".name_current_status").text("관리");
            $(".points_current_status").text(data.percent + "%");
            $(".done_current_status").css({
                'width': data.percent + "%"
            });
        } else if ( data.level == 4 ){
            $(".ic_level").attr('src','img/ic-level-gentleman@2x.png');
            $(".name_current_status").text("양반");
            $(".points_current_status").text(data.percent + "%");
            $(".done_current_status").css({
                'width': data.percent + "%"
            });
        } else if ( data.level == 5 ){
            $(".ic_level").attr('src','img/ic-level-king@2x.png');
            $(".name_current_status").text("왕");
            $(".points_current_status").text(data.percent + "%");
            $(".done_current_status").css({
                'width': data.percent + "%"
            });
        }
        //계급 이름, 사진 변경과 퍼센테이지 변경
        if ( data.level == 1 ){
            $(".rec1_current1_mainLevel").append("<img src='img/indicator-box@2x.png' class='indicator_box'><div class='rec1_indicatorNm_mainLevel'>현재 계급</div>");
        } else if ( data.level == 2 ){
            $(".rec1_current2_mainLevel").append("<img src='img/indicator-box@2x.png' class='indicator_box'><div class='rec1_indicatorNm_mainLevel'>현재 계급</div>");
        } else if ( data.level == 3 ){
            $(".rec1_current3_mainLevel").append("<img src='img/indicator-box@2x.png' class='indicator_box'><div class='rec1_indicatorNm_mainLevel'>현재 계급</div>");
        } else if ( data.level == 4 ){
            $(".rec1_current4_mainLevel").append("<img src='img/indicator-box@2x.png' class='indicator_box'><div class='rec1_indicatorNm_mainLevel'>현재 계급</div>");
        } else if ( data.level == 5 ){
            $(".rec1_current5_mainLevel").append("<img src='img/indicator-box@2x.png' class='indicator_box'><div class='rec1_indicatorNm_mainLevel'>현재 계급</div>");
        } 
    }});
</script>
</body>
</html>
